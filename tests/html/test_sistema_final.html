<!DOCTYPE html><html lang="pt-BR"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Teste Sistema Final - CEP</title>    <style>        body {            font-family: Arial, sans-serif;            max-width: 800px;            margin: 0 auto;            padding: 20px;        }        .form-group {            margin-bottom: 15px;        }        label {            display: block;            margin-bottom: 5px;            font-weight: bold;        }        input {            width: 100%;            padding: 8px;            border: 1px solid #ddd;            border-radius: 4px;            box-sizing: border-box;        }        input[readonly] {            background-color: #f5f5f5;        }        button {            background-color: #007bff;            color: white;            padding: 10px 20px;            border: none;            border-radius: 4px;            cursor: pointer;            margin-top: 10px;        }        button:hover {            background-color: #0056b3;        }        .log {            background-color: #f8f9fa;            padding: 15px;            border-radius: 4px;            margin-top: 20px;            font-family: monospace;            font-size: 12px;            max-height: 300px;            overflow-y: auto;            border: 1px solid #ddd;        }        .test-section {            border: 1px solid #ddd;            padding: 15px;            margin-bottom: 20px;            border-radius: 4px;        }        .instructions {            background-color: #e7f3ff;            padding: 15px;            border-radius: 4px;            margin-bottom: 20px;        }    </style></head><body>    <h1>Teste do Sistema Final - Funcionalidade CEP</h1>        <div class="instructions">        <h3>Instruções:</h3>        <ol>            <li>Este teste simula exatamente o formulário do sistema final</li>            <li>Digite um CEP válido (ex: 01310-100) no campo CEP</li>            <li>O CEP deve ser formatado automaticamente (00000-000)</li>            <li>Quando completar 8 dígitos, a busca deve ser feita automaticamente</li>            <li>Os campos readonly devem ser preenchidos automaticamente</li>            <li>Teste também o botão "Buscar CEP" manualmente</li>            <li>Observe os logs no console do navegador (F12)</li>        </ol>    </div>    <div class="test-section">        <h3>Formulário de Novo Chamado (Simulação do Sistema Final)</h3>        <form id="newTicketForm">            <div class="form-group">                <label for="ticketTitle">Título:</label>                <input type="text" id="ticketTitle" name="title" required>            </div>                        <div class="form-group">                <label for="ticketPriority">Prioridade:</label>                <select id="ticketPriority" name="priority">                    <option value="baixa">Baixa</option>                    <option value="media" selected>Média</option>                    <option value="alta">Alta</option>                    <option value="critica">Crítica</option>                </select>            </div>                        <div class="form-group">                <label for="ticketCategory">Categoria:</label>                <select id="ticketCategory" name="category">                    <option value="hardware">Hardware</option>                    <option value="software">Software</option>                    <option value="rede">Rede</option>                    <option value="email">E-mail</option>                    <option value="outros">Outros</option>                </select>            </div>                        <div class="form-group">                <label for="requesterName">Nome de quem está abrindo o chamado:</label>                <input type="text" id="requesterName" name="requester_name" required>            </div>                        <div class="form-group">                <label for="requesterRegistration">Matrícula:</label>                <input type="text" id="requesterRegistration" name="requester_registration" required>            </div>                        <div class="form-group">                <label for="unitSigla">Unidade/Sigla da Loja/Agência:</label>                <input type="text" id="unitSigla" name="unit_sigla" required>            </div>                        <div class="form-group">                <label for="zipcode">CEP:</label>                <input type="text" id="zipcode" name="zipcode" placeholder="00000-000" maxlength="9" required>                <button type="button" id="searchCepBtn" class="btn btn-sm btn-secondary" style="margin-top: 5px;">Buscar CEP</button>            </div>                        <div class="form-group">                <label for="address">Endereço Completo:</label>                <input type="text" id="address" name="address" readonly>            </div>                        <div class="form-group">                <label for="city">Cidade:</label>                <input type="text" id="city" name="city" readonly>            </div>                        <div class="form-group">                <label for="state">Estado (UF):</label>                <input type="text" id="state" name="state" maxlength="2" readonly>            </div>                        <div class="form-group">                <label for="ticketDescription">Descrição:</label>                <textarea id="ticketDescription" name="description" rows="4" required></textarea>            </div>                        <button type="submit" class="btn btn-primary">Abrir Chamado</button>        </form>    </div>        <div class="log" id="log">        Aguardando teste...    </div>    <script>        function log(message) {            const logDiv = document.getElementById('log');            const timestamp = new Date().toLocaleTimeString();            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;            logDiv.scrollTop = logDiv.scrollHeight;        }        // Função de busca de CEP (copiada do script-vercel.js)        async function searchCep() {            console.log('=== INICIANDO BUSCA DE CEP ===');            log('=== INICIANDO BUSCA DE CEP ===');                        const zipcodeInput = document.getElementById('zipcode');            console.log('Campo zipcode encontrado:', !!zipcodeInput);            if (!zipcodeInput) {                console.error('ERRO: Campo de CEP não encontrado');                log('ERRO: Campo de CEP não encontrado');                alert('Erro: Campo de CEP não encontrado. Recarregue a página.');                return;            }                        const zipcode = zipcodeInput.value.replace(/\D/g, '');            console.log('CEP digitado (após limpeza):', zipcode);            log(`CEP digitado: ${zipcode}`);                        if (zipcode.length !== 8) {                console.log('ERRO: CEP deve conter 8 dígitos, mas tem', zipcode.length);                log('ERRO: CEP deve conter 8 dígitos');                alert('CEP deve conter 8 dígitos');                return;            }                        // Mostrar feedback de carregamento            const searchBtn = document.getElementById('searchCepBtn');            const originalText = searchBtn ? searchBtn.textContent : '';            if (searchBtn) {                searchBtn.textContent = 'Buscando...';                searchBtn.disabled = true;            }                        try {                console.log('Fazendo requisição para ViaCEP...');                log('Fazendo requisição para ViaCEP...');                const url = `https://viacep.com.br/ws/${zipcode}/json/`;                console.log('URL completa:', url);                                const response = await fetch(url);                console.log('Status da resposta:', response.status);                                if (!response.ok) {                    throw new Error(`Erro HTTP: ${response.status}`);                }                                const data = await response.json();                console.log('Dados recebidos do ViaCEP:', data);                log(`Dados recebidos: ${JSON.stringify(data)}`);                                if (data.erro) {                    console.log('ERRO: CEP não encontrado na base do ViaCEP');                    log('ERRO: CEP não encontrado');                    alert('CEP não encontrado. Verifique se o CEP está correto.');                    if (searchBtn) {                        searchBtn.textContent = originalText;                        searchBtn.disabled = false;                    }                    return;                }                                // Preencher campos de endereço                const addressInput = document.getElementById('address');                const cityInput = document.getElementById('city');                const stateInput = document.getElementById('state');                                console.log('=== VERIFICANDO CAMPOS DE DESTINO ===');                console.log('Campo address encontrado:', !!addressInput);                console.log('Campo city encontrado:', !!cityInput);                console.log('Campo state encontrado:', !!stateInput);                                log('Preenchendo campos...');                                if (addressInput) {                    let endereco = data.logradouro || '';                    if (data.complemento) {                        endereco += ', ' + data.complemento;                    }                    if (data.bairro) {                        endereco += ' - ' + data.bairro;                    }                                        const enderecoFinal = endereco.trim();                    console.log('Endereço final a ser preenchido:', enderecoFinal);                                        // Remover readonly temporariamente                    const wasReadonly = addressInput.hasAttribute('readonly');                    if (wasReadonly) {                        addressInput.removeAttribute('readonly');                        console.log('Atributo readonly removido temporariamente');                    }                                        addressInput.value = enderecoFinal;                    addressInput.setAttribute('value', enderecoFinal);                    addressInput.dispatchEvent(new Event('input', { bubbles: true }));                    addressInput.dispatchEvent(new Event('change', { bubbles: true }));                                        if (wasReadonly) {                        addressInput.setAttribute('readonly', 'readonly');                        console.log('Atributo readonly restaurado');                    }                                        console.log('Valor após preenchimento:', addressInput.value);                    log(`Endereço preenchido: "${addressInput.value}"`);                }                                if (cityInput) {                    const cidade = data.localidade || '';                    const wasReadonly = cityInput.hasAttribute('readonly');                    if (wasReadonly) {                        cityInput.removeAttribute('readonly');                    }                                        cityInput.value = cidade;                    cityInput.setAttribute('value', cidade);                    cityInput.dispatchEvent(new Event('input', { bubbles: true }));                    cityInput.dispatchEvent(new Event('change', { bubbles: true }));                                        if (wasReadonly) {                        cityInput.setAttribute('readonly', 'readonly');                    }                                        console.log('Cidade preenchida:', cityInput.value);                    log(`Cidade preenchida: "${cityInput.value}"`);                }                                if (stateInput) {                    const estado = data.uf || '';                    const wasReadonly = stateInput.hasAttribute('readonly');                    if (wasReadonly) {                        stateInput.removeAttribute('readonly');                    }                                        stateInput.value = estado;                    stateInput.setAttribute('value', estado);                    stateInput.dispatchEvent(new Event('input', { bubbles: true }));                    stateInput.dispatchEvent(new Event('change', { bubbles: true }));                                        if (wasReadonly) {                        stateInput.setAttribute('readonly', 'readonly');                    }                                        console.log('Estado preenchido:', stateInput.value);                    log(`Estado preenchido: "${stateInput.value}"`);                }                                console.log('=== SUCESSO: CEP encontrado e campos preenchidos! ===');                log('SUCESSO: Campos preenchidos!');                            } catch (error) {                console.error('ERRO na busca de CEP:', error);                log(`ERRO: ${error.message}`);                alert('Erro ao buscar CEP. Verifique sua conexão com a internet.\n\nDetalhes: ' + error.message);            } finally {                if (searchBtn) {                    searchBtn.textContent = originalText;                    searchBtn.disabled = false;                }                console.log('=== FIM DA BUSCA DE CEP ===');            }        }        // Event listeners        document.addEventListener('DOMContentLoaded', function() {            log('Página carregada, configurando listeners...');                        // Botão buscar CEP            const searchCepBtn = document.getElementById('searchCepBtn');            if (searchCepBtn) {                searchCepBtn.addEventListener('click', function(e) {                    e.preventDefault();                    e.stopPropagation();                    console.log('=== BOTÃO BUSCAR CEP CLICADO ===');                    log('Botão buscar CEP clicado');                    searchCep();                    return false;                });                log('Listener do botão buscar CEP configurado');            }                        // Formatação de CEP ao digitar            const zipcodeInput = document.getElementById('zipcode');            if (zipcodeInput) {                zipcodeInput.addEventListener('input', function(e) {                    let value = e.target.value.replace(/\D/g, '');                    if (value.length <= 8) {                        if (value.length >= 5) {                            e.target.value = value.replace(/(\d{5})(\d{0,3})/, '$1-$2');                        } else {                            e.target.value = value;                        }                                                console.log(`CEP formatado: ${e.target.value}`);                                                if (value.length === 8) {                            console.log('CEP completo detectado, buscando automaticamente...');                            log('CEP completo detectado, buscando automaticamente...');                            setTimeout(() => searchCep(), 500);                        }                    }                });                log('Listener do campo CEP configurado');            }                        log('Configuração concluída. Teste digitando um CEP válido.');            log('CEPs para teste: 01310-100, 20040-020, 40070-110');        });    </script></body></html>