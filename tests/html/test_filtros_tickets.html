<!DOCTYPE html><html lang="pt-BR"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Teste de Filtros de Tickets</title>    <link rel="stylesheet" href="styles.css">    <link rel="stylesheet" href="tickets_table.css">    <link rel="stylesheet" href="notifications.css">    <style>        body {            font-family: Arial, sans-serif;            max-width: 1200px;            margin: 0 auto;            padding: 20px;        }        .test-section {            border: 1px solid #ddd;            padding: 15px;            margin-bottom: 20px;            border-radius: 4px;        }        .log {            background-color: #f8f9fa;            padding: 15px;            border-radius: 4px;            margin-top: 20px;            font-family: monospace;            font-size: 12px;            max-height: 300px;            overflow-y: auto;            border: 1px solid #ddd;        }        .notification {            position: fixed;            top: 20px;            right: 20px;            padding: 10px 20px;            border-radius: 4px;            color: white;            z-index: 1000;        }        .notification-success {            background-color: #10b981;        }        .notification-error {            background-color: #ef4444;        }        .notification-info {            background-color: #06b6d4;        }        .filter-controls {            display: flex;            gap: 10px;            margin-bottom: 20px;            flex-wrap: wrap;        }        .filter-controls select {            padding: 8px 12px;            border: 1px solid #ddd;            border-radius: 4px;            background-color: white;        }    </style></head><body>    <h1>Teste de Filtros de Tickets</h1>        <div class="test-section">        <h3>Controles de Teste</h3>        <button onclick="criarTicketsTeste()">Criar Tickets de Teste</button>        <button onclick="limparDados()">Limpar Dados</button>        <button onclick="resetarFiltros()">Resetar Filtros</button>    </div>        <div class="test-section">        <h3>Filtros - Perfil Suporte</h3>        <div class="filter-controls">            <select id="statusFilter">                <option value="">Todos os Status</option>                <option value="aberto">Aberto</option>                <option value="em_andamento">Em Andamento</option>                <option value="fechado">Fechado</option>            </select>            <select id="priorityFilter">                <option value="">Todas as Prioridades</option>                <option value="baixa">Baixa</option>                <option value="media">Média</option>                <option value="alta">Alta</option>                <option value="critica">Crítica</option>            </select>        </div>        <table class="tickets-table">            <thead>                <tr>                    <th>ID</th>                    <th>Título</th>                    <th>Usuário</th>                    <th>Status</th>                    <th>Prioridade</th>                    <th>Data</th>                    <th>Ações</th>                </tr>            </thead>            <tbody id="supportTicketsBody">                <tr>                    <td colspan="7">Nenhum ticket encontrado</td>                </tr>            </tbody>        </table>    </div>        <div class="test-section">        <h3>Filtros - Perfil Administrador</h3>        <div class="filter-controls">            <select id="adminStatusFilter">                <option value="">Todos os Status</option>                <option value="aberto">Aberto</option>                <option value="em_andamento">Em Andamento</option>                <option value="fechado">Fechado</option>            </select>            <select id="adminPriorityFilter">                <option value="">Todas as Prioridades</option>                <option value="baixa">Baixa</option>                <option value="media">Média</option>                <option value="alta">Alta</option>                <option value="critica">Crítica</option>            </select>            <select id="adminUserFilter">                <option value="">Todos os Usuários</option>            </select>        </div>        <table class="tickets-table">            <thead>                <tr>                    <th>ID</th>                    <th>Título</th>                    <th>Usuário</th>                    <th>Status</th>                    <th>Prioridade</th>                    <th>Atribuído a</th>                    <th>Data</th>                    <th>Ações</th>                </tr>            </thead>            <tbody id="adminTicketsBody">                <tr>                    <td colspan="8">Nenhum ticket encontrado</td>                </tr>            </tbody>        </table>    </div>        <div class="log" id="log">        Aguardando teste...    </div>    <script>        // Simular o sistema de tickets        let tickets = [];        let users = [            { id: 1, name: 'João Silva', type: 'user' },            { id: 2, name: 'Maria Santos', type: 'user' },            { id: 3, name: 'Pedro Costa', type: 'user' },            { id: 4, name: 'Ana Lima', type: 'user' }        ];        function log(message) {            const logDiv = document.getElementById('log');            const timestamp = new Date().toLocaleTimeString();            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;            logDiv.scrollTop = logDiv.scrollHeight;        }        function showNotification(message, type = 'info') {            const notification = document.createElement('div');            notification.className = `notification notification-${type}`;            notification.textContent = message;                        document.body.appendChild(notification);                        setTimeout(() => {                notification.remove();            }, 3000);        }        function getStatusText(status) {            const statusMap = {                'aberto': 'Aberto',                'em_andamento': 'Em Andamento',                'fechado': 'Fechado'            };            return statusMap[status] || status;        }        function getPriorityText(priority) {            const priorityMap = {                'baixa': 'Baixa',                'media': 'Média',                'alta': 'Alta',                'critica': 'Crítica'            };            return priorityMap[priority] || priority;        }        function formatDate(dateString) {            const date = new Date(dateString);            return date.toLocaleDateString('pt-BR') + ' ' + date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });        }        // Configurar listeners dos filtros        function setupFilterListeners() {            log('Configurando listeners dos filtros...');                        // Filtros do perfil de suporte            const statusFilter = document.getElementById('statusFilter');            const priorityFilter = document.getElementById('priorityFilter');                        if (statusFilter) {                statusFilter.addEventListener('change', function() {                    log('Filtro de status alterado: ' + this.value);                    filterSupportTickets();                });                log('Listener do filtro de status configurado');            }                        if (priorityFilter) {                priorityFilter.addEventListener('change', function() {                    log('Filtro de prioridade alterado: ' + this.value);                    filterSupportTickets();                });                log('Listener do filtro de prioridade configurado');            }                        // Filtros do perfil de administrador            const adminStatusFilter = document.getElementById('adminStatusFilter');            const adminPriorityFilter = document.getElementById('adminPriorityFilter');            const adminUserFilter = document.getElementById('adminUserFilter');                        if (adminStatusFilter) {                adminStatusFilter.addEventListener('change', function() {                    log('Filtro de status (admin) alterado: ' + this.value);                    filterAdminTickets();                });                log('Listener do filtro de status (admin) configurado');            }                        if (adminPriorityFilter) {                adminPriorityFilter.addEventListener('change', function() {                    log('Filtro de prioridade (admin) alterado: ' + this.value);                    filterAdminTickets();                });                log('Listener do filtro de prioridade (admin) configurado');            }                        if (adminUserFilter) {                adminUserFilter.addEventListener('change', function() {                    log('Filtro de usuário (admin) alterado: ' + this.value);                    filterAdminTickets();                });                log('Listener do filtro de usuário (admin) configurado');            }        }        // Filtrar tickets do perfil de suporte        function filterSupportTickets() {            log('=== FILTRANDO TICKETS DO SUPORTE ===');                        const statusFilter = document.getElementById('statusFilter');            const priorityFilter = document.getElementById('priorityFilter');                        const statusValue = statusFilter ? statusFilter.value : '';            const priorityValue = priorityFilter ? priorityFilter.value : '';                        log('Filtros aplicados:');            log('- Status: ' + (statusValue || 'Todos'));            log('- Prioridade: ' + (priorityValue || 'Todas'));                        let filteredTickets = [...tickets];                        // Filtrar por status            if (statusValue) {                filteredTickets = filteredTickets.filter(ticket => ticket.status === statusValue);                log(`Filtrados por status "${statusValue}": ${filteredTickets.length} tickets`);            }                        // Filtrar por prioridade            if (priorityValue) {                filteredTickets = filteredTickets.filter(ticket => ticket.priority === priorityValue);                log(`Filtrados por prioridade "${priorityValue}": ${filteredTickets.length} tickets`);            }                        log(`Total de tickets após filtros: ${filteredTickets.length}`);                        // Atualizar a tabela com os tickets filtrados            updateSupportTicketsTable(filteredTickets);        }        // Filtrar tickets do perfil de administrador        function filterAdminTickets() {            log('=== FILTRANDO TICKETS DO ADMINISTRADOR ===');                        const statusFilter = document.getElementById('adminStatusFilter');            const priorityFilter = document.getElementById('adminPriorityFilter');            const userFilter = document.getElementById('adminUserFilter');                        const statusValue = statusFilter ? statusFilter.value : '';            const priorityValue = priorityFilter ? priorityFilter.value : '';            const userValue = userFilter ? userFilter.value : '';                        log('Filtros aplicados:');            log('- Status: ' + (statusValue || 'Todos'));            log('- Prioridade: ' + (priorityValue || 'Todas'));            log('- Usuário: ' + (userValue || 'Todos'));                        let filteredTickets = [...tickets];                        // Filtrar por status            if (statusValue) {                filteredTickets = filteredTickets.filter(ticket => ticket.status === statusValue);                log(`Filtrados por status "${statusValue}": ${filteredTickets.length} tickets`);            }                        // Filtrar por prioridade            if (priorityValue) {                filteredTickets = filteredTickets.filter(ticket => ticket.priority === priorityValue);                log(`Filtrados por prioridade "${priorityValue}": ${filteredTickets.length} tickets`);            }                        // Filtrar por usuário            if (userValue) {                filteredTickets = filteredTickets.filter(ticket => ticket.userId == userValue);                log(`Filtrados por usuário "${userValue}": ${filteredTickets.length} tickets`);            }                        log(`Total de tickets após filtros: ${filteredTickets.length}`);                        // Atualizar a tabela com os tickets filtrados            updateAdminTicketsTable(filteredTickets);        }        // Atualizar tabela de tickets do suporte com dados filtrados        function updateSupportTicketsTable(filteredTickets) {            const tbody = document.getElementById('supportTicketsBody');                        if (tbody) {                if (filteredTickets.length === 0) {                    tbody.innerHTML = '<tr><td colspan="7">Nenhum ticket encontrado com os filtros aplicados</td></tr>';                    return;                }                tbody.innerHTML = filteredTickets.map(ticket => {                    const user = users.find(u => u.id === ticket.userId);                    return `                        <tr>                            <td>#${ticket.id}</td>                            <td>${ticket.title}</td>                            <td>${user ? user.name : 'N/A'}</td>                            <td><span class="status-badge status-${ticket.status}">${getStatusText(ticket.status)}</span></td>                            <td><span class="priority-badge priority-${ticket.priority}">${getPriorityText(ticket.priority)}</span></td>                            <td>${formatDate(ticket.createdAt)}</td>                            <td>                                <button class="btn btn-sm btn-primary" onclick="viewTicket(${ticket.id})">Ver</button>                                <button class="btn btn-sm btn-secondary" onclick="assignTicket(${ticket.id})">Atribuir</button>                            </td>                        </tr>                    `;                }).join('');            }        }        // Atualizar tabela de tickets do administrador com dados filtrados        function updateAdminTicketsTable(filteredTickets) {            const tbody = document.getElementById('adminTicketsBody');                        if (tbody) {                if (filteredTickets.length === 0) {                    tbody.innerHTML = '<tr><td colspan="8">Nenhum ticket encontrado com os filtros aplicados</td></tr>';                    return;                }                tbody.innerHTML = filteredTickets.map(ticket => {                    const user = users.find(u => u.id === ticket.userId);                    const assignedUser = users.find(u => u.id === ticket.assignedTo);                    return `                        <tr>                            <td>#${ticket.id}</td>                            <td>${ticket.title}</td>                            <td>${user ? user.name : 'N/A'}</td>                            <td><span class="status-badge status-${ticket.status}">${getStatusText(ticket.status)}</span></td>                            <td><span class="priority-badge priority-${ticket.priority}">${getPriorityText(ticket.priority)}</span></td>                            <td>${assignedUser ? assignedUser.name : 'Não atribuído'}</td>                            <td>${formatDate(ticket.createdAt)}</td>                            <td>                                <button class="btn btn-sm btn-primary" onclick="viewTicket(${ticket.id})">Ver</button>                                <button class="btn btn-sm btn-secondary" onclick="editTicket(${ticket.id})">Editar</button>                            </td>                        </tr>                    `;                }).join('');            }        }        // Configurar filtro de usuários no perfil de administrador        function setupAdminUserFilter() {            const userFilter = document.getElementById('adminUserFilter');            if (userFilter) {                // Limpar opções existentes (exceto a primeira)                userFilter.innerHTML = '<option value="">Todos os Usuários</option>';                                // Adicionar usuários                users.forEach(user => {                    if (user.type === 'user') { // Apenas usuários normais, não admins/suporte                        const option = document.createElement('option');                        option.value = user.id;                        option.textContent = user.name;                        userFilter.appendChild(option);                    }                });                                log(`Filtro de usuários configurado com ${users.filter(u => u.type === 'user').length} usuários`);            }        }        function viewTicket(ticketId) {            const ticket = tickets.find(t => t.id === ticketId);            if (ticket) {                log(`Visualizando ticket #${ticketId}: ${ticket.title}`);                alert(`Ticket #${ticketId}\nTítulo: ${ticket.title}\nStatus: ${getStatusText(ticket.status)}`);            }        }        function assignTicket(ticketId) {            log(`Atribuindo ticket #${ticketId}`);            showNotification('Ticket atribuído com sucesso!', 'success');        }        function editTicket(ticketId) {            log(`Editando ticket #${ticketId}`);            showNotification('Ticket editado com sucesso!', 'success');        }        function criarTicketsTeste() {            const novosTickets = [                {                    id: tickets.length + 1,                    title: 'Problema com impressora',                    description: 'A impressora não está funcionando',                    status: 'aberto',                    priority: 'media',                    category: 'hardware',                    userId: 1,                    createdAt: new Date().toISOString()                },                {                    id: tickets.length + 2,                    title: 'Erro no sistema',                    description: 'Sistema apresentando erro',                    status: 'em_andamento',                    priority: 'alta',                    category: 'software',                    userId: 2,                    createdAt: new Date().toISOString()                },                {                    id: tickets.length + 3,                    title: 'Problema de rede',                    description: 'Internet não está funcionando',                    status: 'fechado',                    priority: 'critica',                    category: 'rede',                    userId: 3,                    createdAt: new Date().toISOString()                },                {                    id: tickets.length + 4,                    title: 'Solicitação de software',                    description: 'Preciso instalar novo software',                    status: 'aberto',                    priority: 'baixa',                    category: 'software',                    userId: 4,                    createdAt: new Date().toISOString()                },                {                    id: tickets.length + 5,                    title: 'Problema com email',                    description: 'Email não está chegando',                    status: 'em_andamento',                    priority: 'media',                    category: 'email',                    userId: 1,                    createdAt: new Date().toISOString()                }            ];                        tickets.push(...novosTickets);            filterSupportTickets();            filterAdminTickets();            log(`Criados ${novosTickets.length} tickets de teste`);        }        function limparDados() {            if (confirm('Tem certeza que deseja limpar todos os dados?')) {                tickets = [];                filterSupportTickets();                filterAdminTickets();                log('Dados limpos');            }        }        function resetarFiltros() {            document.getElementById('statusFilter').value = '';            document.getElementById('priorityFilter').value = '';            document.getElementById('adminStatusFilter').value = '';            document.getElementById('adminPriorityFilter').value = '';            document.getElementById('adminUserFilter').value = '';                        filterSupportTickets();            filterAdminTickets();            log('Filtros resetados');        }        // Inicialização        document.addEventListener('DOMContentLoaded', function() {            log('Página carregada, inicializando...');            setupFilterListeners();            setupAdminUserFilter();            filterSupportTickets();            filterAdminTickets();            log('Sistema inicializado. Teste criando tickets e usando os filtros.');        });    </script></body></html>