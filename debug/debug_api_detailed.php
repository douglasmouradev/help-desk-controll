<?php// Debug detalhado da APIerror_reporting(E_ALL);ini_set('display_errors', 1);echo "<h1>üîç Debug Detalhado da API</h1>";// Simular requisi√ß√£o POST$_POST['action'] = 'login';$_POST['username'] = 'admin';$_POST['password'] = 'Controll IT@10';echo "<h2>1. Dados enviados:</h2>";echo "Action: " . $_POST['action'] . "<br>";echo "Username: " . $_POST['username'] . "<br>";echo "Password: " . $_POST['password'] . "<br>";echo "<h2>2. Testando API passo a passo:</h2>";// Testar conex√£o com bancotry {    $pdo = new PDO('mysql:host=localhost;dbname=helpdesk_titanium', 'root', '');    echo "‚úÖ Conex√£o com banco: OK<br>";        // Verificar usu√°rio    $stmt = $pdo->prepare("SELECT * FROM users WHERE username = ?");    $stmt->execute(['admin']);    $user = $stmt->fetch(PDO::FETCH_ASSOC);        if ($user) {        echo "‚úÖ Usu√°rio encontrado: {$user['username']}<br>";        echo "Tipo: {$user['type']}<br>";        echo "Ativo: {$user['is_active']}<br>";                // Testar senha        $isValid = password_verify('Controll IT@10', $user['password']);        echo "Senha v√°lida: " . ($isValid ? "‚úÖ SIM" : "‚ùå N√ÉO") . "<br>";                if ($isValid) {            echo "<h3>üéâ LOGIN DEVERIA FUNCIONAR!</h3>";                        // Simular gera√ß√£o de token            $payload = [                'user_id' => $user['id'],                'username' => $user['username'],                'type' => $user['type'],                'exp' => time() + 3600            ];                        echo "Payload do token: " . json_encode($payload, JSON_PRETTY_PRINT) . "<br>";                    } else {            echo "<h3>‚ùå PROBLEMA: Senha inv√°lida!</h3>";        }    } else {        echo "‚ùå Usu√°rio n√£o encontrado!<br>";    }    } catch (PDOException $e) {    echo "‚ùå Erro na conex√£o: " . $e->getMessage() . "<br>";}echo "<h2>3. Testando API diretamente:</h2>";// Capturar sa√≠da da APIob_start();include 'api/auth.php';$output = ob_get_clean();echo "<h3>Resposta da API:</h3>";echo "<pre>" . htmlspecialchars($output) . "</pre>";// Verificar se √© JSON v√°lido$json = json_decode($output, true);if ($json) {    echo "<h3>An√°lise da resposta:</h3>";    echo "Success: " . ($json['success'] ? 'true' : 'false') . "<br>";    echo "Message: " . $json['message'] . "<br>";        if (isset($json['data'])) {        echo "Data presente: ‚úÖ<br>";        if (isset($json['data']['token'])) {            echo "Token presente: ‚úÖ<br>";        } else {            echo "Token ausente: ‚ùå<br>";        }        if (isset($json['data']['user'])) {            echo "User presente: ‚úÖ<br>";        } else {            echo "User ausente: ‚ùå<br>";        }    } else {        echo "Data ausente: ‚ùå<br>";    }} else {    echo "‚ùå Resposta n√£o √© JSON v√°lido!<br>";}echo "<h2>4. Teste via cURL:</h2>";$postData = json_encode([    'username' => 'admin',    'password' => 'Controll IT@10']);$ch = curl_init();curl_setopt($ch, CURLOPT_URL, 'http://localhost/sistema-web-Controll IT/api/auth.php?action=login');curl_setopt($ch, CURLOPT_POST, true);curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);$response = curl_exec($ch);$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);curl_close($ch);echo "HTTP Code: $httpCode<br>";echo "Resposta cURL: " . htmlspecialchars($response) . "<br>";if ($httpCode == 200) {    $json = json_decode($response, true);    if ($json && $json['success']) {        echo "<h3>‚úÖ API FUNCIONANDO VIA cURL!</h3>";    } else {        echo "<h3>‚ùå API FALHANDO VIA cURL!</h3>";        echo "Erro: " . ($json['message'] ?? 'Desconhecido') . "<br>";    }} else {    echo "<h3>‚ùå ERRO HTTP: $httpCode</h3>";}echo "<h2>5. Verificar Logs de Erro:</h2>";$errorLog = ini_get('error_log');echo "Log de erros: $errorLog<br>";if (file_exists($errorLog)) {    $errors = file_get_contents($errorLog);    $recentErrors = array_slice(explode("\n", $errors), -5);    echo "√öltimos 5 erros:<br>";    echo "<pre>" . implode("\n", $recentErrors) . "</pre>";}echo "<hr>";echo "<h2>üìã Resumo:</h2>";echo "<p>Se a API estiver funcionando via cURL mas n√£o via frontend, o problema est√° na comunica√ß√£o.</p>";echo "<p><strong>Teste:</strong> <a href='http://localhost/sistema-web-Controll IT/'>Sistema Principal</a></p>";?>